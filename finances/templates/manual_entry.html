{% extends "base.html" %}
{% block navbar_budget %} class="active" {% endblock %}

{% block mainpane %}
  <div class="container-fluid">
    <form role="form"> 
      <div class="form-group">
        <label class="col-xs-3 control-label">Date</label>
        <div class="col-xs-9">
          <input class="datepicker form-control" id="date" type="text">
        </div>
      </div>
     <div class="form-group">
        <label class="col-xs-3 control-label">Name</label>
        <div class="col-xs-9">
          <input class="form-control" id="name" type="text">
        </div>
      </div>
      <div class="form-group">
        <label class="col-xs-3 control-label">Amount</label>
        <div class="col-xs-9">
          <input class="form-control" id="amount" type="text">
        </div>
      </div>
      <div class="form-group">
        <label class="col-xs-3 control-label">Category</label>
        <div class="col-xs-9">
          <select class="form-control" id="category">
          {% for c in categories %}
            <option value='{{c[0]}}'>{{c[1]}}</option>
          {% endfor %}
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="col-xs-3 control-label">Deduct</label>
        <div class="col-xs-9">
          <select class="form-control" id="deduct">
          {% for c in categories %}
            <option value='{{c[0]}}'>{{c[1]}}</option>
          {% endfor %}
          </select>
        </div>
      </div>
      <div class="form-group">
        <label class="col-xs-3 control-label">&nbsp</label>
        <div class="col-xs-9">
          <input class="btn btn-default" id="add_item" value="add" readonly>
        </div>
      </div>
    </form>
  </div>
{% endblock %}

{% block scripts %}
  {{super()}}
<script>
$(document).ready(function(){
  $('input#add_item').click(function(){
    var entry = {
      date: $('input#date').val(),
      name: $('input#name').val(),
      amount: $('input#amount').val(),
      category_id: $('select#category').val(),
      deduct_id: $('select#deduct').val(),
    };
    //console.log(entry);
    $.post(
      "{{url_for('transaction.rest_manual_entry')}}", 
      { entry: JSON.stringify(entry) },
      function(data, status) {
        $("input#date").val('');
        $("input#name").val('');
        $("input#amount").val('');
        $("select#category").val('{{ categories[0][1] }}');
        $("select#deduct").val('{{ categories[0][1] }}');
      }
    );
  });
});
</script>
{% endblock %}

